<!DOCTYPE html>
<html lang="vi">
nguyen vu
dddddddddddddddddddd
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Quản Lý Booking Du Lịch</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        :root {
            --primary: #1d4ed8;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #111827;
            --light: #f9fafb;
            --gray: #6b7280;
            --border: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f3f4f6;
            color: var(--dark);
            line-height: 1.6;
        }

        /* Login Screen */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-box h1 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .login-box p {
            margin-bottom: 30px;
            color: var(--gray);
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        input,
        select {
            width: 100%;
            padding: 12px 16px;
            border: 1.5px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(29, 78, 216, 0.1);
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #1e40af;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); color: white; }
        .btn-primary { background: var(--primary); }

        .btn-success:hover { background: #059669; }
        .btn-danger:hover { background: #dc2626; }
        .btn-warning:hover { background: #d97706; }
        .btn-primary:hover { background: #1e40af; }

        /* Admin Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
        }

        header {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--gray);
        }

        .container {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
        }

        .stat-card i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-card h3 {
            font-size: 1.8rem;
            margin: 10px 0;
            color: var(--dark);
        }

        .stat-card p {
            color: var(--gray);
            font-size: 0.95rem;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--gray);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .tab-content.active {
            display: block;
        }

        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th,
        td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: #f8fafc;
            font-weight: 600;
            color: var(--dark);
        }

        .actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-domestic {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-international {
            background: #fef3c7;
            color: #d97706;
        }

        .badge-custom {
            background: #f0fdf4;
            color: #166534;
        }

        .tour-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            margin-top: 5px;
        }

        .print-area {
            padding: 40px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 12px;
            margin: 20px 0;
            display: none;
        }

        .print-area img {
            max-width: 200px;
            height: auto;
            margin: 15px auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
        }

        .close {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #000;
        }

        .image-preview {
            margin-top: 10px;
            text-align: center;
        }

        .image-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        @media print {
            body>*:not(.print-area) {
                display: none;
            }

            .print-area,
            .print-area * {
                visibility: visible;
            }

            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .row {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>

    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <h1>Admin Login</h1>
            <p>Đăng nhập để quản lý hệ thống</p>
            <div class="form-group">
                <label>Mật khẩu</label>
                <input type="password" id="adminPassword" placeholder="Nhập mật khẩu" />
            </div>
            <button class="btn" onclick="login()">Đăng Nhập</button>
            <p style="margin-top: 15px; font-size: 0.9rem; color: #ef4444;">Mật khẩu: <strong>admin123</strong></p>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="dashboard" class="dashboard">
        <header>
            <div class="logo">
                Admin Panel
            </div>
            <div class="user-menu">
                <span>Admin</span>
                <button class="btn btn-danger btn-sm" onclick="logout()">
                    Đăng xuất
                </button>
            </div>
        </header>

        <div class="container">
            <!-- Stats -->
            <div class="stats">
                <div class="stat-card">
                    <h3 id="totalTours">0</h3>
                    <p>Tour đang hoạt động</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalHDV">0</h3>
                    <p>Hướng dẫn viên</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalBookings">0</h3>
                    <p>Khách hôm nay</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalRevenue">0 ₫</h3>
                    <p>Doanh thu hôm nay</p>
                </div>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <div class="tab active" onclick="openTab('tabTours')">Quản Lý Tour</div>
                <div class="tab" onclick="openTab('tabHDV')">Quản Lý HDV</div>
            </div>

            <!-- Tab: Quản Lý Tour -->
            <div id="tabTours" class="tab-content active">
                <h2 id="formTitle">Tạo Tour Mới</h2>
                <div class="row">
                    <div class="form-group">
                        <label>Loại Tour</label>
                        <select id="tourType">
                            <option value="domestic">Trong Nước</option>
                            <option value="international">Nước Ngoài</option>
                            <option value="custom">Tour Theo Yêu Cầu</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tên Tour</label>
                        <input type="text" id="tourName" placeholder="VD: Tour Đà Lạt 3N2Đ" />
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Hướng Dẫn Viên</label>
                        <select id="tourHDV"></select>
                    </div>
                    <div class="form-group">
                        <label>Ngày Khởi Hành</label>
                        <input type="date" id="tourDeparture" />
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Số Ngày</label>
                        <input type="number" id="tourDuration" min="1" value="3" />
                    </div>
                    <div class="form-group">
                        <label>Giá Người Lớn (VNĐ)</label>
                        <input type="number" id="tourAdultPrice" value="2500000" />
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Giá Trẻ Em (VNĐ)</label>
                        <input type="number" id="tourChildPrice" value="1500000" />
                    </div>
                    <div class="form-group">
                        <label>Ảnh Tour</label>
                        <input type="file" id="tourImage" accept="image/*" />
                        <div class="image-preview" id="imagePreview"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Ghi Chú</label>
                    <input type="text" id="tourNote" placeholder="Bao gồm: xe, khách sạn..." />
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn btn-success" id="saveTourBtn" onclick="addTour()">
                        Tạo Tour
                    </button>
                    <button class="btn btn-danger" id="cancelEditBtn" onclick="cancelEdit()" style="display:none;">
                        Hủy
                    </button>
                </div>

                <h3 style="margin-top: 30px;">Danh Sách Tour</h3>
                <div id="toursList"></div>
            </div>

            <!-- Tab: Quản Lý HDV -->
            <div id="tabHDV" class="tab-content">
                <h2>Thêm HDV Mới</h2>
                <div class="row">
                    <div class="form-group">
                        <label>Họ Tên</label>
                        <input type="text" id="hdvName" placeholder="Nguyễn Văn A" />
                    </div>
                    <div class="form-group">
                        <label>SĐT</label>
                        <input type="text" id="hdvPhone" placeholder="0901234567" />
                    </div>
                </div>
                <button class="btn btn-success" onclick="addHDV()">
                    Thêm HDV
                </button>

                <h3 style="margin-top: 30px;">Danh Sách HDV</h3>
                <div id="hdvList"></div>
            </div>
        </div>

        <!-- Print Area -->
        <div class="print-area" id="printArea"></div>

        <!-- Modal: Thêm Khách -->
        <div id="customerModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <h3>Thêm Khách Vào Tour</h3>
                <input type="hidden" id="currentTourId" />
                <div class="form-group">
                    <label>Loại Khách</label>
                    <select id="modalCustomerType">
                        <option value="adult">Người lớn</option>
                        <option value="child">Trẻ em</option>
                    </select>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label>Họ Tên</label>
                        <input type="text" id="modalCustomerName" placeholder="Nguyễn Thị B" />
                    </div>
                    <div class="form-group">
                        <label>SĐT</label>
                        <input type="text" id="modalCustomerPhone" placeholder="0901234567" />
                    </div>
                </div>
                <div style="display:flex; gap:10px;">
                    <button class="btn btn-success" onclick="saveCustomer()">Thêm</button>
                    <button class="btn btn-danger" onclick="closeModal()">Hủy</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dữ liệu
        let hdvList = JSON.parse(localStorage.getItem('hdvList')) || [
            { id: 1, name: 'Trần Văn Kiên', phone: '0901112222' },
            { id: 2, name: 'Nguyễn Thành Đạt', phone: '0903334444' },
            { id: 3, name: 'Lê Thị Duyên', phone: '0905556666' }
        ];

        let tours = JSON.parse(localStorage.getItem('tours')) || [];
        let editingTourId = null;

        const ADMIN_PASSWORD = 'admin123';

        // Login
        function login() {
            const pass = document.getElementById('adminPassword').value;
            if (pass === ADMIN_PASSWORD) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            } else {
                alert('Sai mật khẩu!');
            }
        }

        function logout() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('adminPassword').value = '';
        }

        // Load Dashboard
        function loadDashboard() {
            updateStats();
            loadHDVSelect();
            renderHDVList();
            renderToursList();
            setupImagePreview();
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            const todayTours = tours.filter(t => t.departure === today);
            const todayCustomers = todayTours.reduce((sum, t) => sum + t.customers.length, 0);
            const todayRevenue = todayTours.reduce((sum, t) => {
                return sum + t.customers.reduce((s, c) => s + (c.type === 'adult' ? t.adultPrice : t.childPrice), 0);
            }, 0);

            document.getElementById('totalTours').textContent = tours.length;
            document.getElementById('totalHDV').textContent = hdvList.length;
            document.getElementById('totalBookings').textContent = todayCustomers;
            document.getElementById('totalRevenue').textContent = formatCurrency(todayRevenue);
        }

        // Tabs
        function openTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelector(`.tab[onclick="openTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // HDV Management
        function loadHDVSelect() {
            const select = document.getElementById('tourHDV');
            select.innerHTML = hdvList.map(h => `<option value="${h.id}">${h.name}</option>`).join('');
        }

        function addHDV() {
            const name = document.getElementById('hdvName').value.trim();
            const phone = document.getElementById('hdvPhone').value.trim();
            if (!name || !phone) return alert('Vui lòng nhập đầy đủ!');
            const newHDV = { id: Date.now(), name, phone };
            hdvList.push(newHDV);
            saveHDV();
            renderHDVList();
            loadHDVSelect();
            document.getElementById('hdvName').value = '';
            document.getElementById('hdvPhone').value = '';
        }

        function removeHDV(id) {
            if (confirm('Xóa HDV này?')) {
                hdvList = hdvList.filter(h => h.id !== id);
                saveHDV();
                renderHDVList();
                loadHDVSelect();
            }
        }

        function saveHDV() {
            localStorage.setItem('hdvList', JSON.stringify(hdvList));
            updateStats();
        }

        function renderHDVList() {
            const list = document.getElementById('hdvList');
            list.innerHTML = `
        <table>
          <tr><th>Họ Tên</th><th>SĐT</th><th>Hành Động</th></tr>
          ${hdvList.map(h => `
            <tr>
              <td><strong>${h.name}</strong></td>
              <td>${h.phone}</td>
              <td class="actions">
                <button class="btn btn-danger btn-sm" onclick="removeHDV(${h.id})">
                  Xóa
                </button>
              </td>
            </tr>
          `).join('')}
        </table>
      `;
        }

        // Tour Management
        function setupImagePreview() {
            const input = document.getElementById('tourImage');
            const preview = document.getElementById('imagePreview');
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                    };
                    reader.readAsDataURL(file);
                } else {
                    preview.innerHTML = '';
                }
            });
        }

        function addTour() {
            const name = document.getElementById('tourName').value.trim();
            const type = document.getElementById('tourType').value;
            const hdvId = document.getElementById('tourHDV').value;
            const departure = document.getElementById('tourDeparture').value;
            const duration = document.getElementById('tourDuration').value;
            const adultPrice = parseInt(document.getElementById('tourAdultPrice').value);
            const childPrice = parseInt(document.getElementById('tourChildPrice').value);
            const note = document.getElementById('tourNote').value;
            const imageInput = document.getElementById('tourImage');
            const imageFile = imageInput.files[0];
            
            if (!name || !departure) return alert('Vui lòng nhập tên tour và ngày khởi hành!');

            const reader = new FileReader();
            const saveTourData = (imageData = null) => {
                const tourData = {
                    id: editingTourId || Date.now(),
                    name, type, hdvId: parseInt(hdvId),
                    departure, duration: parseInt(duration),
                    adultPrice, childPrice, note,
                    customers: editingTourId ? (tours.find(t => t.id === editingTourId)?.customers || []) : [],
                    image: imageData
                };

                if (editingTourId) {
                    const index = tours.findIndex(t => t.id === editingTourId);
                    tours[index] = tourData;
                } else {
                    tours.push(tourData);
                }

                localStorage.setItem('tours', JSON.stringify(tours));
                renderToursList();
                updateStats();
                clearTourForm();
                cancelEdit();
            };

            if (imageFile) {
                const reader = new FileReader();
                reader.onload = () => saveTourData(reader.result);
                reader.readAsDataURL(imageFile);
            } else {
                saveTourData(editingTourId ? tours.find(t => t.id === editingTourId)?.image : null);
            }
        }

        function editTour(id) {
            const tour = tours.find(t => t.id === id);
            if (!tour) return;

            editingTourId = id;
            document.getElementById('formTitle').textContent = 'Chỉnh Sửa Tour';
            document.getElementById('saveTourBtn').textContent = 'Cập Nhật Tour';
            document.getElementById('cancelEditBtn').style.display = 'inline-block';

            document.getElementById('tourType').value = tour.type;
            document.getElementById('tourName').value = tour.name;
            document.getElementById('tourHDV').value = tour.hdvId;
            document.getElementById('tourDeparture').value = tour.departure;
            document.getElementById('tourDuration').value = tour.duration;
            document.getElementById('tourAdultPrice').value = tour.adultPrice;
            document.getElementById('tourChildPrice').value = tour.childPrice;
            document.getElementById('tourNote').value = tour.note || '';

            const preview = document.getElementById('imagePreview');
            if (tour.image) {
                preview.innerHTML = `<img src="${tour.image}" alt="Current">`;
            } else {
                preview.innerHTML = '';
            }

            document.querySelector(`.tab.active`).click();
        }

        function cancelEdit() {
            editingTourId = null;
            document.getElementById('formTitle').textContent = 'Tạo Tour Mới';
            document.getElementById('saveTourBtn').textContent = 'Tạo Tour';
            document.getElementById('cancelEditBtn').style.display = 'none';
            clearTourForm();
        }

        function clearTourForm() {
            document.getElementById('tourName').value = '';
            document.getElementById('tourDeparture').value = '';
            document.getElementById('tourNote').value = '';
            document.getElementById('tourImage').value = '';
            document.getElementById('imagePreview').innerHTML = '';
        }

        function openAddCustomerModal(tourId) {
            document.getElementById('currentTourId').value = tourId;
            document.getElementById('customerModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('customerModal').style.display = 'none';
            document.getElementById('modalCustomerName').value = '';
            document.getElementById('modalCustomerPhone').value = '';
        }

        function saveCustomer() {
            const tourId = parseInt(document.getElementById('currentTourId').value);
            const name = document.getElementById('modalCustomerName').value.trim();
            const phone = document.getElementById('modalCustomerPhone').value.trim();
            const type = document.getElementById('modalCustomerType').value;

            if (!name || !phone) return alert('Vui lòng nhập họ tên và SĐT!');

            const tour = tours.find(t => t.id === tourId);
            tour.customers.push({ name, phone, type });

            localStorage.setItem('tours', JSON.stringify(tours));
            renderToursList();
            updateStats();
            closeModal();
        }

        function renderToursList() {
            const list = document.getElementById('toursList');
            list.innerHTML = `
        <table>
          <tr><th>Ảnh</th><th>Tour</th><th>HDV</th><th>Ngày</th><th>Giá</th><th>Khách</th><th>Tổng</th><th></th></tr>
          ${tours.map(t => {
                const hdv = hdvList.find(h => h.id === t.hdvId);
                const badge = t.type === 'domestic' ? 'badge-domestic' : t.type === 'international' ? 'badge-international' : 'badge-custom';
                const typeText = t.type === 'domestic' ? 'Trong Nước' : t.type === 'international' ? 'Nước Ngoài' : 'Theo Yêu Cầu';
                const total = t.customers.reduce((s, c) => s + (c.type === 'adult' ? t.adultPrice : t.childPrice), 0);
                return `
              <tr>
                <td>${t.image ? `<img src="${t.image}" class="tour-image" alt="Tour">` : '<i class="fas fa-image" style="color:#ccc;font-size:2rem;"></i>'}</td>
                <td><strong>${t.name}</strong><br><span class="badge ${badge}">${typeText}</span></td>
                <td>${hdv?.name || 'Chưa gán'}</td>
                <td>${formatDate(t.departure)}<br><small>${t.duration} ngày</small></td>
                <td>NL: ${formatCurrency(t.adultPrice)}<br>TE: ${formatCurrency(t.childPrice)}</td>
                <td>${t.customers.length} khách</td>
                <td><strong>${formatCurrency(total)}</strong></td>
                <td class="actions">
                  <button class="btn btn-primary btn-sm" onclick="openAddCustomerModal(${t.id})">
                    Thêm
                  </button>
                  <button class="btn btn-warning btn-sm" onclick="editTour(${t.id})">
                    Sửa
                  </button>
                  <button class="btn btn-success btn-sm" onclick="printTourInvoice(${t.id})">
                    In
                  </button>
                  <button class="btn btn-danger btn-sm" onclick="removeTour(${t.id})">
                    Xóa
                  </button>
                </td>
              </tr>
            `;
            }).join('')}
        </table>
      `;
        }

        function removeTour(id) {
            if (confirm('Xóa tour này?')) {
                tours = tours.filter(t => t.id !== id);
                localStorage.setItem('tours', JSON.stringify(tours));
                renderToursList();
                updateStats();
            }
        }

        // In hóa đơn
        function printTourInvoice(tourId) {
            const tour = tours.find(t => t.id === tourId);
            if (!tour || tour.customers.length === 0) return alert('Không có khách để in!');

            const hdv = hdvList.find(h => h.id === tour.hdvId);
            const total = tour.customers.reduce((s, c) => s + (c.type === 'adult' ? tour.adultPrice : tour.childPrice), 0);

            const printArea = document.getElementById('printArea');
            printArea.innerHTML = `
        <div style="text-align:center; margin-bottom:30px;">
          <h1 style="color:#1d4ed8;">HÓA ĐƠN ĐẶT TOUR</h1>
          <p><strong>HDV:</strong> ${hdv?.name || 'N/A'} | <strong>Ngày in:</strong> ${new Date().toLocaleDateString('vi-VN')}</p>
        </div>
        ${tour.image ? `<img src="${tour.image}" alt="Tour">` : ''}
        <table style="width:100%; margin-bottom:20px;">
          <tr><td><strong>Tour:</strong></td><td>${tour.name}</td></tr>
          <tr><td><strong>Khởi hành:</strong></td><td>${formatDate(tour.departure)} (${tour.duration} ngày)</td></tr>
          <tr><td><strong>Ghi chú:</strong></td><td>${tour.note || 'Không có'}</td></tr>
        </table>
        <h3>Danh sách khách:</h3>
        <table style="width:100%; border-collapse:collapse;">
          <tr style="background:#f3f4f6;"><th style="text-align:left;padding:8px;">Họ tên</th><th>SĐT</th><th>Loại</th><th>Giá</th></tr>
          ${tour.customers.map(c => `
            <tr style="border-bottom:1px solid #ddd;">
              <td style="padding:8px;">${c.name}</td>
              <td>${c.phone}</td>
              <td>${c.type === 'adult' ? 'Người lớn' : 'Trẻ em'}</td>
              <td style="text-align:right;">${formatCurrency(c.type === 'adult' ? tour.adultPrice : tour.childPrice)}</td>
            </tr>
          `).join('')}
        </table>
        <div style="border-top:2px dashed #ccc; padding-top:15px; margin-top:20px; text-align:right;">
          <p style="font-size:1.4rem; font-weight:bold;">
            TỔNG TIỀN: ${formatCurrency(total)}
          </p>
        </div>
      `;
            printArea.style.display = 'block';
            window.print();
            printArea.style.display = 'none';
        }

        // Utility
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        }

        function formatDate(date) {
            return new Date(date).toLocaleDateString('vi-VN');
        }

        // Khởi tạo
        document.getElementById('tourDeparture').min = new Date().toISOString().split('T')[0];
    </script>
</body>

</html>